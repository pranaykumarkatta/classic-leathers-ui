<html>
<head>
    <title>Classic Leathers</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="shortcut icon" type="image/png" href="./resource/classic_logo_icon.png">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/body.css">
    <script>
        var app = angular.module("classicLeathers", []);

        app.controller("timeSheetController", function($scope,$http) {
            $scope.employeeList = ["Select","PRANAY","KRISHNA","PRASAD","RAJU","MANI"];
            $scope.selectedEmployeeName=$scope.employeeList[0];
             $scope.saveInTime = function() {
                if($scope.selectedEmployeeName=="Select"){
                    confirm("Invalid Employee Name");
                }else{
                    var confirmation = confirm("Saving In Time For : " +$scope.selectedEmployeeName);
                    if(confirmation==true){
                        var data={
                            "employeeName": $scope.selectedEmployeeName,
                            "entryType": "In",
                        }
                        $http.post('http://localhost:8080/timeSheet',data,{})
                        .then(data => {
                            $scope.message="Data Saved Successfully for In Time"
                            setTimeout(() => {
                                window.location.reload();
                            }, 5000);
                        })
                        .catch(error => {
                            console.log(error.value);
                        });
                    }else{
                         window.location.reload();
                    }
                }
            }
             $scope.saveOutTime = function() {
                if($scope.selectedEmployeeName=="Select"){
                    confirm("Invalid Employee Name");
                }else{
                    var confirmation = confirm("Saving Out Time For : " +$scope.selectedEmployeeName);
                    if(confirmation==true){
                        var data={
                            "employeeName": $scope.selectedEmployeeName,
                            "entryType": "Out",
                        }
                        $http.post('http://localhost:8080/timeSheet',data,{})
                        .then(data => {
                            $scope.message="Data Saved Successfully for Out Time"
                            setTimeout(() => {
                                window.location.reload();
                            }, 5000);
                        })
                        .catch(error => {
                            console.log(error.value);
                        });
                    }else{
                         window.location.reload();
                    }
                }
            }


            $http({method: 'GET', url: 'http://localhost:8080/timeSheet'})
            .then(function successCallback(response) {
					$scope.timeSheetEntryList=response.data;
					console.log(response.data)
                },function errorCallback(response) {
					console.log(error.value);
                }
            );


         });


    </script>

</head>
<body class="classicTheamColor" ng-app="classicLeathers">
<div class="header_div">
    <img class="images" src="./resource/classic_logo.png"/>
    <div class="menu_div container">
        <label class="welcome_label">RETAIL STORE TIRUPATI</label>
        <a href=".\ClassicLeathersMenu.html" class="btn btn-primary">Home</a>
        <a href=".\ClassicLeathers_welcomePage.html" class="btn btn-primary">Sales</a>
        <a href=".\ClassicLeathersExpense.html" class="btn btn-primary">Expense</a>
    </div>
</div>

<div ng-controller="timeSheetController" class="working_div container">
    <h4><label ng-bind="selectedEmployeeName "></label> <label> : </label> <label ng-bind="message"></label></label>
    </h4>
    <h4><label>Employee Name:</label> <select class="btn btn-primary" ng-model="selectedEmployeeName"
                                              ng-options="x for x in employeeList"></select>
        &nbsp&nbsp&nbsp<input type="button" href=".\ClassicLeathersMenu.html" class="btn btn-primary"
                              ng-click="saveInTime()" value="Stepping In"></input>
        <input type="button" href=".\ClassicLeathersMenu.html" class="btn btn-primary" ng-click="saveOutTime()"
               value="Stepping Out"></input>
    </h4>
    <table class="table table-font">
        <tr>
            <th>Date</th>
            <th>Employee Name</th>
            <th>Present</th>
            <th>Total Working Hours</th>
        </tr>

        <tr ng-repeat="timeSheetEntry in timeSheetEntryList">
            <td>{{timeSheetEntry.date}}</td>
            <td>{{timeSheetEntry.employeeName}}</td>
            <td>{{timeSheetEntry.present}}</td>
            <td>{{timeSheetEntry.totalWorkingHours}}</td>
        </tr>

    </table>

</div>
</body>
</html>
